def transform(input):
    """
    Make sure that pentests are performed on a cadence commensurate with policy and risk tolerance

    Parameters:
        input (dict): The JSON data containing rapid7insightvm API response

    Returns:
        dict: A dictionary with the arePenTestsCompleted evaluation result
    """

    criteria_key = "arePenTestsCompleted"

    try:
        # Handle nested response structures
        if 'response' in input:
            input = input['response']
        if 'apiResponse' in input:
            input = input['apiResponse']
        if 'result' in input:
            input = input['result']

        # Check penetration testing completion
        tests_completed = False
        test_details = {}

        # Check for test/scan indicators
        if 'scans' in input:
            scans = input['scans'] if isinstance(input['scans'], list) else []
            completed_scans = [s for s in scans if s.get('status') == 'completed']
            tests_completed = len(completed_scans) > 0
            test_details['completedScans'] = len(completed_scans)
            test_details['totalScans'] = len(scans)
        elif 'tests' in input:
            tests = input['tests'] if isinstance(input['tests'], list) else []
            completed_tests = [t for t in tests if t.get('status') == 'completed']
            tests_completed = len(completed_tests) > 0
            test_details['completedTests'] = len(completed_tests)
            test_details['totalTests'] = len(tests)
        elif 'lastScanDate' in input or 'lastTestDate' in input:
            last_date = input.get('lastScanDate', input.get('lastTestDate'))
            tests_completed = bool(last_date)
            test_details['lastDate'] = last_date
        elif 'completed' in input:
            tests_completed = bool(input['completed'])

        return {
            criteria_key: tests_completed,
            **test_details
        }

    except Exception as e:
        return {
            criteria_key: False,
            "error": str(e)
        }
