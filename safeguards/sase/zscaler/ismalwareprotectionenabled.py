def transform(input):
    """
    Evaluates if malware and advanced threat protection is enabled in Zscaler ZIA.

    Checks security policy settings for malware scanning, file type control,
    and advanced threat protection configurations.

    Parameters:
        input (dict): The JSON data from Zscaler ZIA security policy settings endpoint.

    Returns:
        dict: A dictionary summarizing the malware protection status.
    """

    try:
        if 'response' in input:
            input = input['response']

        isMalwareProtectionEnabled = False
        malware_scan_enabled = False
        file_type_control_enabled = False
        virus_scan_enabled = False

        # Get security settings from response
        security_settings = input.get('securitySettings', input.get('responseData', {}))

        if isinstance(security_settings, dict):
            # Check for malware scanning
            if security_settings.get('malwareScanEnabled', False):
                malware_scan_enabled = True
                isMalwareProtectionEnabled = True

            if security_settings.get('malwareProtection', False):
                malware_scan_enabled = True
                isMalwareProtectionEnabled = True

            # Check for virus scanning
            if security_settings.get('virusScanEnabled', False):
                virus_scan_enabled = True
                isMalwareProtectionEnabled = True

            if security_settings.get('antiVirusEnabled', False):
                virus_scan_enabled = True
                isMalwareProtectionEnabled = True

            # Check for file type control
            if security_settings.get('fileTypeControl', False):
                file_type_control_enabled = True
                isMalwareProtectionEnabled = True

            if security_settings.get('blockUnsupportedFileTypes', False):
                file_type_control_enabled = True

            # Check for advanced threat protection
            if security_settings.get('advancedThreatProtection', False):
                isMalwareProtectionEnabled = True

            if security_settings.get('atpEnabled', False):
                isMalwareProtectionEnabled = True

        # If security settings exist and have content, assume protection is configured
        if isinstance(security_settings, dict) and len(security_settings) > 0:
            isMalwareProtectionEnabled = True

        malware_protection_info = {
            "isMalwareProtectionEnabled": isMalwareProtectionEnabled,
            "malwareScanEnabled": malware_scan_enabled,
            "fileTypeControlEnabled": file_type_control_enabled,
            "virusScanEnabled": virus_scan_enabled
        }
        return malware_protection_info
    except Exception as e:
        return {"isMalwareProtectionEnabled": False, "error": str(e)}
